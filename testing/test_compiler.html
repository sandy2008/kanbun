<!DOCTYPE html>
<html>
<head>
    <title>Kanbun Compiler Test</title>
</head>
<body>
    <h1>Testing Kanbun Compiler</h1>
    <div id="result"></div>
    
    <script src="js/kanbun-compiler.js"></script>
    <script>
        // Test Fibonacci compilation
        const fibonacciCode = `夫「Fibonacci」者、受「甲」、
　若甲小於二、還甲。
　否、還Fibonacci之甲減一與Fibonacci之甲減二之和。

昔有數曰「結果」、其値Fibonacci之十。
書結果。`;

        console.log('Testing Fibonacci compilation...');
        const compiler = new KanbunCompiler();
        const result = compiler.compile(fibonacciCode);
        
        const resultDiv = document.getElementById('result');
        
        if (result.success) {
            resultDiv.innerHTML = `
                <h2>✅ Compilation Successful!</h2>
                <h3>Generated JavaScript:</h3>
                <pre>${result.javascript}</pre>
                <h3>Execution Test:</h3>
                <div id="execution-result"></div>
            `;
            
            // Try to execute the generated code
            try {
                eval(result.javascript);
                document.getElementById('execution-result').innerHTML = '<p>✅ JavaScript executed successfully! Check console for output.</p>';
            } catch (error) {
                document.getElementById('execution-result').innerHTML = `<p>❌ Execution error: ${error.message}</p>`;
            }
        } else {
            resultDiv.innerHTML = `
                <h2>❌ Compilation Failed</h2>
                <p>Error: ${result.error}</p>
                <h3>Tokens:</h3>
                <pre>${JSON.stringify(result.tokens, null, 2)}</pre>
            `;
        }
        
        console.log('Full result:', result);
    </script>
</body>
</html>
